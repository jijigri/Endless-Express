[gd_scene load_steps=42 format=3 uid="uid://ca6n0kxrbos4v"]

[ext_resource type="Script" path="res://Scripts/Entities/Player/Player.gd" id="1_kf8ds"]
[ext_resource type="Script" path="res://Scripts/Resources/PlayerMovementData.gd" id="2_hfknh"]
[ext_resource type="Shader" path="res://Shaders/OutlineShader.gdshader" id="3_0ljuv"]
[ext_resource type="Texture2D" uid="uid://bgn334x3mulwc" path="res://Sprites/Misc/16pxSquare.png" id="4_e4djc"]
[ext_resource type="Script" path="res://Scenes/Entities/Players/PlayerAnimations.gd" id="5_hcjrv"]
[ext_resource type="Texture2D" uid="uid://by7paajtwxm1j" path="res://Sprites/Effects/PlayerRunParticles.png" id="6_u4y0n"]
[ext_resource type="PackedScene" uid="uid://cfoemwbbnhoxt" path="res://Scenes/Tools/health_manager.tscn" id="7_h3fvv"]
[ext_resource type="Script" path="res://Scenes/Tools/PlayerHealthManager.gd" id="8_4wvtj"]
[ext_resource type="Script" path="res://Scenes/Entities/Players/EnergyManager.gd" id="9_ecau3"]
[ext_resource type="PackedScene" uid="uid://b7lq6gjy6c3df" path="res://Scenes/Tools/hurtbox.tscn" id="10_4xr4n"]
[ext_resource type="Script" path="res://Scenes/Entities/Players/PlayerCamera.gd" id="11_lwkd7"]
[ext_resource type="Script" path="res://Scripts/Entities/Player/PlayerGun.gd" id="12_5qtuk"]
[ext_resource type="Texture2D" uid="uid://ctoxm2mh6bdp7" path="res://Sprites/Guns/DefaultPlayerGuns.png" id="13_bphp0"]
[ext_resource type="Script" path="res://Scripts/Entities/Player/PlayerAbilities.gd" id="14_57n7w"]
[ext_resource type="PackedScene" uid="uid://dlseb4whqrry5" path="res://Scenes/Tools/overhead_health_bar.tscn" id="15_biygl"]
[ext_resource type="Script" path="res://Scenes/Tools/PlayerOverheadHealthBar.gd" id="16_kv2wk"]
[ext_resource type="Script" path="res://Scripts/Entities/Player/PlayerMagnet.gd" id="17_akl8o"]

[sub_resource type="Resource" id="Resource_clju4"]
resource_local_to_scene = true
script = ExtResource("2_hfknh")
speed = 240.0
initial_gravity = 1200.0
jump_force = 370.0
ground_acceleration = 0.18
ground_deceleration = 0.25
air_acceleration = 0.15
air_deceleration = 0.0
jump_apex_treshold = 50.0
jump_apex_gravity_multiplier = 0.5
fall_gravity_multiplier = 1.5
max_gravity = 1600.0
coyote_time = 0.125
buffered_jump_time = 0.15
initial_number_of_jumps = 1
dash_force = 600.0
dash_time = 0.1
initial_number_of_dashes = 0
max_wall_slide_gravity = 220.0
wall_jump_force = Vector2(300, 465)
wall_jump_recover_time = 0.0

[sub_resource type="RectangleShape2D" id="RectangleShape2D_wh57q"]
resource_local_to_scene = true
size = Vector2(16, 31)

[sub_resource type="ShaderMaterial" id="ShaderMaterial_abq6a"]
shader = ExtResource("3_0ljuv")
shader_parameter/outline_color = null
shader_parameter/width_multiplier = 0.0

[sub_resource type="AtlasTexture" id="AtlasTexture_ii0sm"]
atlas = ExtResource("4_e4djc")
region = Rect2(0, 0, 16, 16)

[sub_resource type="AtlasTexture" id="AtlasTexture_045ea"]
atlas = ExtResource("4_e4djc")
region = Rect2(0, 0, 16, 16)

[sub_resource type="AtlasTexture" id="AtlasTexture_nkf3l"]
atlas = ExtResource("4_e4djc")
region = Rect2(0, 0, 16, 16)

[sub_resource type="AtlasTexture" id="AtlasTexture_2u0bw"]
atlas = ExtResource("4_e4djc")
region = Rect2(0, 0, 16, 16)

[sub_resource type="AtlasTexture" id="AtlasTexture_rjbwd"]
atlas = ExtResource("4_e4djc")
region = Rect2(0, 0, 16, 16)

[sub_resource type="SpriteFrames" id="SpriteFrames_tg3fr"]
animations = [{
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_ii0sm")
}],
"loop": true,
"name": &"fall",
"speed": 5.0
}, {
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_045ea")
}],
"loop": true,
"name": &"idle",
"speed": 5.0
}, {
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_nkf3l")
}],
"loop": true,
"name": &"jump",
"speed": 5.0
}, {
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_2u0bw")
}],
"loop": true,
"name": &"run",
"speed": 5.0
}, {
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_rjbwd")
}],
"loop": true,
"name": &"wall_slide",
"speed": 5.0
}]

[sub_resource type="Animation" id="Animation_awl0x"]
resource_name = "fall"

[sub_resource type="Animation" id="Animation_skuh5"]
resource_name = "idle"

[sub_resource type="Animation" id="Animation_ohx3p"]
resource_name = "jump"

[sub_resource type="Animation" id="Animation_lqmn5"]
resource_name = "run"

[sub_resource type="Animation" id="Animation_aukoq"]
resource_name = "wall_slide"

[sub_resource type="AnimationLibrary" id="AnimationLibrary_f4sa6"]
_data = {
"fall": SubResource("Animation_awl0x"),
"idle": SubResource("Animation_skuh5"),
"jump": SubResource("Animation_ohx3p"),
"run": SubResource("Animation_lqmn5"),
"wall_slide": SubResource("Animation_aukoq")
}

[sub_resource type="Curve" id="Curve_qwqea"]
_data = [Vector2(0, 0), 0.0, 24.3515, 0, 0, Vector2(0.087108, 1), 0.0, 0.0, 0, 0, Vector2(0.184669, 1), -0.372728, -0.372728, 0, 0, Vector2(1, 0), -0.954545, 0.0, 0, 0]
point_count = 4

[sub_resource type="CurveTexture" id="CurveTexture_ggfbh"]
curve = SubResource("Curve_qwqea")

[sub_resource type="ParticleProcessMaterial" id="ParticleProcessMaterial_1us57"]
lifetime_randomness = 0.75
emission_shape = 3
emission_box_extents = Vector3(3, 0.1, 1)
particle_flag_disable_z = true
direction = Vector3(-1, 0, 0)
spread = 0.0
gravity = Vector3(0, 0, 0)
orbit_velocity_min = 0.0
orbit_velocity_max = 0.0
scale_min = 0.4
scale_max = 0.8
scale_curve = SubResource("CurveTexture_ggfbh")

[sub_resource type="Curve" id="Curve_03klt"]
_data = [Vector2(0, 0.85), 0.0, 0.25, 0, 0, Vector2(1, 1), 0.0, 0.0, 0, 0]
point_count = 2

[sub_resource type="Curve" id="Curve_s6b0g"]
_data = [Vector2(0, 1), 0.0, -0.9, 0, 0, Vector2(1, 0.6), -0.164577, 0.0, 0, 0]
point_count = 2

[sub_resource type="RectangleShape2D" id="RectangleShape2D_vx8a4"]
resource_local_to_scene = true
size = Vector2(14, 24)

[sub_resource type="AtlasTexture" id="AtlasTexture_u58ad"]
atlas = ExtResource("13_bphp0")
region = Rect2(0, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_sl73q"]
atlas = ExtResource("13_bphp0")
region = Rect2(64, 0, 32, 32)

[sub_resource type="CircleShape2D" id="CircleShape2D_hwa8o"]
radius = 64.0

[node name="PlayerBase" type="CharacterBody2D" groups=["Player"]]
z_index = 6
collision_mask = 13
collision_priority = 5.0
floor_block_on_wall = false
platform_on_leave = 2
script = ExtResource("1_kf8ds")
movement_data = SubResource("Resource_clju4")

[node name="CollisionShape2D" type="CollisionShape2D" parent="."]
position = Vector2(0, 0.5)
shape = SubResource("RectangleShape2D_wh57q")

[node name="Sprite" type="AnimatedSprite2D" parent="."]
texture_repeat = 1
material = SubResource("ShaderMaterial_abq6a")
position = Vector2(0, 16)
sprite_frames = SubResource("SpriteFrames_tg3fr")
animation = &"wall_slide"
offset = Vector2(0, -8)
script = ExtResource("5_hcjrv")

[node name="AnimationPlayer" type="AnimationPlayer" parent="Sprite"]
libraries = {
"": SubResource("AnimationLibrary_f4sa6")
}

[node name="RunParticles" type="GPUParticles2D" parent="Sprite"]
scale = Vector2(1e-05, 1e-05)
amount = 2
process_material = SubResource("ParticleProcessMaterial_1us57")
texture = ExtResource("6_u4y0n")
lifetime = 0.2
explosiveness = 0.4
randomness = 0.2
draw_order = 0

[node name="HealthManager" parent="." instance=ExtResource("7_h3fvv")]
script = ExtResource("8_4wvtj")
damage_modifier_curve = SubResource("Curve_03klt")
danger_zone_value = 25
danger_damage_modifier = 0.75
iframe_time = 0.15
danger_iframe_time = 0.3
danger_start_iframe = 0.6
healing_modifier_curve = SubResource("Curve_s6b0g")
health_to_kill = -8

[node name="EnergyManager" type="Node2D" parent="."]
script = ExtResource("9_ecau3")
max_energy = 280.0

[node name="Hurtbox" parent="." node_paths=PackedStringArray("health_manager") instance=ExtResource("10_4xr4n")]
collision_mask = 0
health_manager = NodePath("../HealthManager")
metadata/isPlayer = true

[node name="CollisionShape2D" parent="Hurtbox" index="0"]
position = Vector2(0, 1)
shape = SubResource("RectangleShape2D_vx8a4")

[node name="Camera" type="Camera2D" parent="."]
limit_left = -600
limit_top = -540
limit_right = 580
limit_bottom = 240
position_smoothing_speed = 10.0
drag_left_margin = 0.0
drag_top_margin = 0.0
drag_right_margin = 0.0
drag_bottom_margin = 0.0
script = ExtResource("11_lwkd7")

[node name="PlayerGun" type="Node2D" parent="." node_paths=PackedStringArray("spawn_point", "ammo_bar")]
z_index = 1
position = Vector2(0, 3)
script = ExtResource("12_5qtuk")
spawn_point = NodePath("Anchor/SpawnPoint")
ammo_bar = NodePath("../AmmoBar")

[node name="Anchor" type="Node2D" parent="PlayerGun"]
position = Vector2(0, 2)

[node name="Sprite" type="Sprite2D" parent="PlayerGun/Anchor"]
texture = SubResource("AtlasTexture_u58ad")
offset = Vector2(7, -2)

[node name="Outline" type="Sprite2D" parent="PlayerGun/Anchor/Sprite"]
z_index = -3
texture = SubResource("AtlasTexture_sl73q")
offset = Vector2(7, -2)

[node name="SpawnPoint" type="Node2D" parent="PlayerGun/Anchor"]
position = Vector2(16, -2)

[node name="Abilities" type="Node2D" parent="."]

[node name="PlayerAbilities" type="Node2D" parent="Abilities" node_paths=PackedStringArray("energy_manager")]
script = ExtResource("14_57n7w")
energy_manager = NodePath("../../EnergyManager")

[node name="MovementAbility" type="Node2D" parent="Abilities"]

[node name="PassiveAbility" type="Node2D" parent="Abilities"]

[node name="OverheadHealthBar" parent="." node_paths=PackedStringArray("health_manager") instance=ExtResource("15_biygl")]
z_index = 20
offset_left = -21.0
offset_top = -29.0
offset_right = 21.0
offset_bottom = -23.0
tint_progress = Color(0.301961, 0.945098, 0.352941, 1)
script = ExtResource("16_kv2wk")
normal_color = Color(0.301961, 0.945098, 0.352941, 1)
danger_color = Color(0.898039, 0.141176, 0.141176, 1)
gain_color = Color(0.317647, 0.396078, 0.870588, 1)
loss_color = Color(0.898039, 0.141176, 0.141176, 1)
health_manager = NodePath("../HealthManager")

[node name="BackHealthBar" parent="OverheadHealthBar" index="0"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
offset_right = 0.0
offset_bottom = 0.0
grow_horizontal = 2
grow_vertical = 2

[node name="OverheadEnergyBar" parent="." node_paths=PackedStringArray("health_manager") instance=ExtResource("15_biygl")]
z_index = 20
offset_left = -21.0
offset_top = -24.0
offset_right = 21.0
offset_bottom = -18.0
tint_progress = Color(0.980392, 0.74902, 0.47451, 1)
health_manager = NodePath("../EnergyManager")

[node name="BackHealthBar" parent="OverheadEnergyBar" index="0"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
offset_right = 0.0
offset_bottom = 0.0
grow_horizontal = 2
grow_vertical = 2
tint_progress = Color(0.807843, 0.176471, 0.45098, 1)

[node name="AmmoBar" type="HBoxContainer" parent="."]
z_index = 20
offset_left = -21.0
offset_top = -39.0
offset_right = 21.0
offset_bottom = -29.0
theme_override_constants/separation = 1
alignment = 1

[node name="Magnet" type="Area2D" parent="."]
collision_layer = 0
collision_mask = 256
monitorable = false
script = ExtResource("17_akl8o")

[node name="CollisionShape2D" type="CollisionShape2D" parent="Magnet"]
shape = SubResource("CircleShape2D_hwa8o")

[node name="AudioListener2D" type="AudioListener2D" parent="."]
current = true

[connection signal="animation_finished" from="Sprite" to="Sprite" method="_on_animation_finished"]
[connection signal="area_entered" from="Magnet" to="Magnet" method="_on_area_entered"]
[connection signal="body_entered" from="Magnet" to="Magnet" method="_on_body_entered"]

[editable path="Hurtbox"]
[editable path="OverheadHealthBar"]
[editable path="OverheadEnergyBar"]
